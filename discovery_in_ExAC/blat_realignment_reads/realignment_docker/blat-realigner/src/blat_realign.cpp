#include "SeqLib/BLATWrapper.h"
using namespace SeqLib;



class RealignmentFilter
{
    private:
		BLATWrapper* bw;
		BLATWrapper* setup_blat_server(){
			BLATWrapper * b = new BLATWrapper();
			BamHeader h("@HD\tVN:1.0\tGO:none\tSO:coordinate\n@SQ\tSN:1\tLN:249250621\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:1b22b98cdeb4a9304cb5d48026a85128\tSP:Homo Sapiens\n@SQ\tSN:2\tLN:243199373\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:a0d9851da00400dec1098a9255ac712e\tSP:Homo Sapiens\n@SQ\tSN:3\tLN:198022430\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:fdfd811849cc2fadebc929bb925902e5\tSP:Homo Sapiens\n@SQ\tSN:4\tLN:191154276\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:23dccd106897542ad87d2765d28a19a1\tSP:Homo Sapiens\n@SQ\tSN:5\tLN:180915260\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:0740173db9ffd264d728f32784845cd7\tSP:Homo Sapiens\n@SQ\tSN:6\tLN:171115067\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:1d3a93a248d92a729ee764823acbbc6b\tSP:Homo Sapiens\n@SQ\tSN:7\tLN:159138663\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:618366e953d6aaad97dbe4777c29375e\tSP:Homo Sapiens\n@SQ\tSN:8\tLN:146364022\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:96f514a9929e410c6651697bded59aec\tSP:Homo Sapiens\n@SQ\tSN:9\tLN:141213431\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:3e273117f15e0a400f01055d9f393768\tSP:Homo Sapiens\n@SQ\tSN:10\tLN:135534747\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:988c28e000e84c26d552359af1ea2e1d\tSP:Homo Sapiens\n@SQ\tSN:11\tLN:135006516\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:98c59049a2df285c76ffb1c6db8f8b96\tSP:Homo Sapiens\n@SQ\tSN:12\tLN:133851895\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:51851ac0e1a115847ad36449b0015864\tSP:Homo Sapiens\n@SQ\tSN:13\tLN:115169878\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:283f8d7892baa81b510a015719ca7b0b\tSP:Homo Sapiens\n@SQ\tSN:14\tLN:107349540\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:98f3cae32b2a2e9524bc19813927542e\tSP:Homo Sapiens\n@SQ\tSN:15\tLN:102531392\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:e5645a794a8238215b2cd77acb95a078\tSP:Homo Sapiens\n@SQ\tSN:16\tLN:90354753\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:fc9b1a7b42b97a864f56b348b06095e6\tSP:Homo Sapiens\n@SQ\tSN:17\tLN:81195210\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:351f64d4f4f9ddd45b35336ad97aa6de\tSP:Homo Sapiens\n@SQ\tSN:18\tLN:78077248\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:b15d4b2d29dde9d3e4f93d1d0f2cbc9c\tSP:Homo Sapiens\n@SQ\tSN:19\tLN:59128983\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:1aacd71f30db8e561810913e0b72636d\tSP:Homo Sapiens\n@SQ\tSN:20\tLN:63025520\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:0dec9660ec1efaaf33281c0d5ea2560f\tSP:Homo Sapiens\n@SQ\tSN:21\tLN:48129895\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:2979a6085bfe28e3ad6f552f361ed74d\tSP:Homo Sapiens\n@SQ\tSN:22\tLN:51304566\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:a718acaa6135fdca8357d5bfe94211dd\tSP:Homo Sapiens\n@SQ\tSN:X\tLN:155270560\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:7e0e2e580297b7764e31dbc80c2540dd\tSP:Homo Sapiens\n@SQ\tSN:Y\tLN:59373566\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:1fa3474750af0948bdf97d5a0ee52e51\tSP:Homo Sapiens\n@SQ\tSN:MT\tLN:16569\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:c68f52674c9fb33aef52dcf399755519\tSP:Homo Sapiens\n@SQ\tSN:GL000207.1\tLN:4262\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:f3814841f1939d3ca19072d9e89f3fd7\tSP:Homo Sapiens\n@SQ\tSN:GL000226.1\tLN:15008\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:1c1b2cd1fccbc0a99b6a447fa24d1504\tSP:Homo Sapiens\n@SQ\tSN:GL000229.1\tLN:19913\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:d0f40ec87de311d8e715b52e4c7062e1\tSP:Homo Sapiens\n@SQ\tSN:GL000231.1\tLN:27386\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:ba8882ce3a1efa2080e5d29b956568a4\tSP:Homo Sapiens\n@SQ\tSN:GL000210.1\tLN:27682\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:851106a74238044126131ce2a8e5847c\tSP:Homo Sapiens\n@SQ\tSN:GL000239.1\tLN:33824\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:99795f15702caec4fa1c4e15f8a29c07\tSP:Homo Sapiens\n@SQ\tSN:GL000235.1\tLN:34474\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:118a25ca210cfbcdfb6c2ebb249f9680\tSP:Homo Sapiens\n@SQ\tSN:GL000201.1\tLN:36148\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:dfb7e7ec60ffdcb85cb359ea28454ee9\tSP:Homo Sapiens\n@SQ\tSN:GL000247.1\tLN:36422\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:7de00226bb7df1c57276ca6baabafd15\tSP:Homo Sapiens\n@SQ\tSN:GL000245.1\tLN:36651\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:89bc61960f37d94abf0df2d481ada0ec\tSP:Homo Sapiens\n@SQ\tSN:GL000197.1\tLN:37175\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:6f5efdd36643a9b8c8ccad6f2f1edc7b\tSP:Homo Sapiens\n@SQ\tSN:GL000203.1\tLN:37498\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:96358c325fe0e70bee73436e8bb14dbd\tSP:Homo Sapiens\n@SQ\tSN:GL000246.1\tLN:38154\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:e4afcd31912af9d9c2546acf1cb23af2\tSP:Homo Sapiens\n@SQ\tSN:GL000249.1\tLN:38502\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:1d78abec37c15fe29a275eb08d5af236\tSP:Homo Sapiens\n@SQ\tSN:GL000196.1\tLN:38914\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:d92206d1bb4c3b4019c43c0875c06dc0\tSP:Homo Sapiens\n@SQ\tSN:GL000248.1\tLN:39786\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:5a8e43bec9be36c7b49c84d585107776\tSP:Homo Sapiens\n@SQ\tSN:GL000244.1\tLN:39929\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:0996b4475f353ca98bacb756ac479140\tSP:Homo Sapiens\n@SQ\tSN:GL000238.1\tLN:39939\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:131b1efc3270cc838686b54e7c34b17b\tSP:Homo Sapiens\n@SQ\tSN:GL000202.1\tLN:40103\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:06cbf126247d89664a4faebad130fe9c\tSP:Homo Sapiens\n@SQ\tSN:GL000234.1\tLN:40531\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:93f998536b61a56fd0ff47322a911d4b\tSP:Homo Sapiens\n@SQ\tSN:GL000232.1\tLN:40652\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:3e06b6741061ad93a8587531307057d8\tSP:Homo Sapiens\n@SQ\tSN:GL000206.1\tLN:41001\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:43f69e423533e948bfae5ce1d45bd3f1\tSP:Homo Sapiens\n@SQ\tSN:GL000240.1\tLN:41933\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:445a86173da9f237d7bcf41c6cb8cc62\tSP:Homo Sapiens\n@SQ\tSN:GL000236.1\tLN:41934\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:fdcd739913efa1fdc64b6c0cd7016779\tSP:Homo Sapiens\n@SQ\tSN:GL000241.1\tLN:42152\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:ef4258cdc5a45c206cea8fc3e1d858cf\tSP:Homo Sapiens\n@SQ\tSN:GL000243.1\tLN:43341\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:cc34279a7e353136741c9fce79bc4396\tSP:Homo Sapiens\n@SQ\tSN:GL000242.1\tLN:43523\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:2f8694fc47576bc81b5fe9e7de0ba49e\tSP:Homo Sapiens\n@SQ\tSN:GL000230.1\tLN:43691\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:b4eb71ee878d3706246b7c1dbef69299\tSP:Homo Sapiens\n@SQ\tSN:GL000237.1\tLN:45867\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:e0c82e7751df73f4f6d0ed30cdc853c0\tSP:Homo Sapiens\n@SQ\tSN:GL000233.1\tLN:45941\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:7fed60298a8d62ff808b74b6ce820001\tSP:Homo Sapiens\n@SQ\tSN:GL000204.1\tLN:81310\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:efc49c871536fa8d79cb0a06fa739722\tSP:Homo Sapiens\n@SQ\tSN:GL000198.1\tLN:90085\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:868e7784040da90d900d2d1b667a1383\tSP:Homo Sapiens\n@SQ\tSN:GL000208.1\tLN:92689\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:aa81be49bf3fe63a79bdc6a6f279abf6\tSP:Homo Sapiens\n@SQ\tSN:GL000191.1\tLN:106433\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:d75b436f50a8214ee9c2a51d30b2c2cc\tSP:Homo Sapiens\n@SQ\tSN:GL000227.1\tLN:128374\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:a4aead23f8053f2655e468bcc6ecdceb\tSP:Homo Sapiens\n@SQ\tSN:GL000228.1\tLN:129120\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:c5a17c97e2c1a0b6a9cc5a6b064b714f\tSP:Homo Sapiens\n@SQ\tSN:GL000214.1\tLN:137718\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:46c2032c37f2ed899eb41c0473319a69\tSP:Homo Sapiens\n@SQ\tSN:GL000221.1\tLN:155397\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:3238fb74ea87ae857f9c7508d315babb\tSP:Homo Sapiens\n@SQ\tSN:GL000209.1\tLN:159169\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:f40598e2a5a6b26e84a3775e0d1e2c81\tSP:Homo Sapiens\n@SQ\tSN:GL000218.1\tLN:161147\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:1d708b54644c26c7e01c2dad5426d38c\tSP:Homo Sapiens\n@SQ\tSN:GL000220.1\tLN:161802\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:fc35de963c57bf7648429e6454f1c9db\tSP:Homo Sapiens\n@SQ\tSN:GL000213.1\tLN:164239\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:9d424fdcc98866650b58f004080a992a\tSP:Homo Sapiens\n@SQ\tSN:GL000211.1\tLN:166566\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:7daaa45c66b288847b9b32b964e623d3\tSP:Homo Sapiens\n@SQ\tSN:GL000199.1\tLN:169874\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:569af3b73522fab4b40995ae4944e78e\tSP:Homo Sapiens\n@SQ\tSN:GL000217.1\tLN:172149\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:6d243e18dea1945fb7f2517615b8f52e\tSP:Homo Sapiens\n@SQ\tSN:GL000216.1\tLN:172294\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:642a232d91c486ac339263820aef7fe0\tSP:Homo Sapiens\n@SQ\tSN:GL000215.1\tLN:172545\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:5eb3b418480ae67a997957c909375a73\tSP:Homo Sapiens\n@SQ\tSN:GL000205.1\tLN:174588\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:d22441398d99caf673e9afb9a1908ec5\tSP:Homo Sapiens\n@SQ\tSN:GL000219.1\tLN:179198\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:f977edd13bac459cb2ed4a5457dba1b3\tSP:Homo Sapiens\n@SQ\tSN:GL000224.1\tLN:179693\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:d5b2fc04f6b41b212a4198a07f450e20\tSP:Homo Sapiens\n@SQ\tSN:GL000223.1\tLN:180455\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:399dfa03bf32022ab52a846f7ca35b30\tSP:Homo Sapiens\n@SQ\tSN:GL000195.1\tLN:182896\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:5d9ec007868d517e73543b005ba48535\tSP:Homo Sapiens\n@SQ\tSN:GL000212.1\tLN:186858\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:563531689f3dbd691331fd6c5730a88b\tSP:Homo Sapiens\n@SQ\tSN:GL000222.1\tLN:186861\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:6fe9abac455169f50470f5a6b01d0f59\tSP:Homo Sapiens\n@SQ\tSN:GL000200.1\tLN:187035\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:75e4c8d17cd4addf3917d1703cacaf25\tSP:Homo Sapiens\n@SQ\tSN:GL000193.1\tLN:189789\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:dbb6e8ece0b5de29da56601613007c2a\tSP:Homo Sapiens\n@SQ\tSN:GL000194.1\tLN:191469\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:6ac8f815bf8e845bb3031b73f812c012\tSP:Homo Sapiens\n@SQ\tSN:GL000225.1\tLN:211173\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:63945c3e6962f28ffd469719a747e73c\tSP:Homo Sapiens\n@SQ\tSN:GL000192.1\tLN:547496\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:GRCh37\tM5:325ba9e808f669dfeee210fdd7b470ac\tSP:Homo Sapiens\n@SQ\tSN:NC_007605\tLN:171823\tUR:http://www.broadinstitute.org/ftp/pub/seq/references/Homo_sapiens_assembly19.fasta\tAS:NC_007605.1\tM5:6743bd63b3ff2b5b8985d8933c53290a\tSP:Epstein-Barr virus\n@RG\tID:C0HV4.4\tPL:illumina\tPU:C0HV4ACXX120402.4.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HV4.6\tPL:illumina\tPU:C0HV4ACXX120402.6.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HV4.7\tPL:illumina\tPU:C0HV4ACXX120402.7.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HV4.8\tPL:illumina\tPU:C0HV4ACXX120402.8.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.1\tPL:illumina\tPU:C0HVYACXX120402.1.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.2\tPL:illumina\tPU:C0HVYACXX120402.2.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.3\tPL:illumina\tPU:C0HVYACXX120402.3.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.4\tPL:illumina\tPU:C0HVYACXX120402.4.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.5\tPL:illumina\tPU:C0HVYACXX120402.5.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.6\tPL:illumina\tPU:C0HVYACXX120402.6.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.7\tPL:illumina\tPU:C0HVYACXX120402.7.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:C0HVY.8\tPL:illumina\tPU:C0HVYACXX120402.8.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.1\tPL:illumina\tPU:D0RE2ACXX120401.1.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.2\tPL:illumina\tPU:D0RE2ACXX120401.2.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.3\tPL:illumina\tPU:D0RE2ACXX120401.3.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.4\tPL:illumina\tPU:D0RE2ACXX120401.4.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.5\tPL:illumina\tPU:D0RE2ACXX120401.5.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.6\tPL:illumina\tPU:D0RE2ACXX120401.6.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.7\tPL:illumina\tPU:D0RE2ACXX120401.7.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RE2.8\tPL:illumina\tPU:D0RE2ACXX120401.8.GACCTAAC\tLB:Pond-147580\tDT:2012-04-01T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RH0.1\tPL:illumina\tPU:D0RH0ACXX120402.1.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI\n@RG\tID:D0RH0.2\tPL:illumina\tPU:D0RH0ACXX120402.2.GACCTAAC\tLB:Pond-147580\tDT:2012-04-02T00:00:00-0400\tSM:HCC1143\tCN:BI");
			
			b->SetHeaderInfo(h);
			b->LoadIndex("/Users/dlivitz/gatk-protected-1.0.0.0-alpha1.2.1/src/test/resources/hg19mini.fasta", "/Users/dlivitz/yourGenome.11.ooc");
			return b;
		}
	
	public:

		RealignmentFilter(){	
			bw = setup_blat_server();
		}

		int blat_seq(const std::string& seq,const std::string& contig,const int mut_position){

			BamRecordVector blat_res;
			bw->AlignSequence("blat",seq,blat_res);

            auto contains_mut=0;
            auto does_not_contain_mut=0;

			for (auto& i : blat_res){

				if (i.Position() < mut_position && i.PositionEnd() >= mut_position )
					contains_mut = std::max(contains_mut,i.GetIntTag("AS"));
				else
					does_not_contain_mut = std::max(does_not_contain_mut,i.GetIntTag("AS"));
			}
			return contains_mut-does_not_contain_mut;
		}

};

int main() {	
	auto rf = RealignmentFilter();
	rf.blat_seq("TAAGGATTTCACAGATTTAAGGTGCTAAAATCACTGGGTTCTCTAAGAGGCCTGGGATTCTTCTGCTGGAAAAATAAGTT","4",14254);
	return 0;
}
